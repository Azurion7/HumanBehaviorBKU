{% extends "base_generic.html" %}


{% load static %}

{% block title %}Upload Video{% endblock %}

{% block videos_content %}
<div class="container">
  <div class="well text-muted text-center" style="padding-top: 1rem; padding-bottom: 1rem;">
    <span class="glyphicon glyphicon-arrow-down" style="font-size: 2rem;"></span>
    <h4>Drop Videos Here to Upload</h4>
  </div>
  <div style="margin-bottom: 20px;">
    <button type="button" class="btn btn-primary js-upload-videos">
      <span class="glyphicon glyphicon-cloud-upload"></span> Upload Videos
    </button>
    <!-- <button type="reset" class="btn btn-warning cancel">
      <span class="glyphicon glyphicon-ban-circle"></span>Cancel Upload
    </button> -->
    <button type="submit" class="btn btn-danger js-delete-all-video">
      <span class="glyphicon glyphicon-trash"></span> Clear Database
    </button>
    <button type="submit" class="btn btn-default btn-outline-secondary js-url-modal pull-right">
      <span class="glyphicon glyphicon-link"></span> URLs Link
    </button>
    <!-- <button type="button" class="btn btn-primary js-extract-feature">
      <span class="glyphicon glyphicon-cloud-upload"></span> Extract Feature
    </button>   -->
    <input id="fileupload" type="file" name="file" multiple accept="video/*,image/gif" style="display: none;"
      data-url="{% url 'catalog:video-upload' %}" data-form-data='{"csrfmiddlewaretoken": "{{ csrf_token }}"}'>
  </div>

  <table id="gallery" class="table table-striped">
    <thead>
      <tr>
        <th>Videos Uploaded</th>
        <th>Size</th>
      </tr>
    </thead>
    <tbody>
      {% csrf_token %}
      {% for video in videos %}
      <tr>
        <td>
          <a href="/catalog/c3d-new/{{video.title}}">{{ video.title }}</a>
        </td>
        <td>
          <span>{{ video.filesize }}</span>
        </td>
        <!-- <td>
              <p class="size">Processing...</p>
              <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>
          </td> -->
        <td>
          <button type="submit" class="btn btn-danger js-delete-videos pull-right" data-type='DELETE' data-url="{{video.file}}" data-id='{{video.id}}'>
            <span class="glyphicon glyphicon-trash"></span> Delete
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="modal fade" id="modal-progress" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Uploading...</h4>
        </div>
        <div class="modal-body">
          <div class="progress">
            <div class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="model-urls" data-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><span class="glyphicon glyphicon-link"></span> Upload with URLs</h5>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <input type="url" class="form-control left-inner-addon input-url" placeholder="url link or youtube..." aria-describedby="basic-addon1">
              <input type="url" class="form-control left-inner-addon input-filename" placeholder="filename..." aria-describedby="basic-addon1">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary js-url-upload">
              <i class="fa fa-spinner fa-spin" style="display: none"></i>
            <span class="glyphicon glyphicon-cloud-upload"></span> Upload
          </button>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

{% block javascript %}
{# JQUERY FILE UPLOAD SCRIPTS #}
<script src="{% static 'js/jquery-file-upload/vendor/jquery.ui.widget.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/jquery.iframe-transport.js' %}"></script>
<script src="{% static 'js/jquery-file-upload/jquery.fileupload.js' %}"></script>

{# VIDEO PAGE SCRIPTS #}
<script src="{% static 'js/upload.js' %}"></script>
<script src="{% static 'celery_progress/celery_progress.js' %}"></script>
{% endblock %}